---
title: "Homework ‚Ññ 2"
author: "Abishev Daur"
output:
  html_document:
    df_print: paged
navigation: frame
fontenc: T2A
lang: russian
babel-lang: russian
header-includes: \usepackage[russian]{babel}
toc-depth: 2

---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(ggm)
library(readxl)
library(ggplot2)
library(ggm)
library(readxl)
library(cluster)
library(ggpubr)
library(factoextra)
library("ISLR")
library("MASS")
```

## –ó–∞–¥–∞–Ω–∏–µ 1


–ò—Å–ø–æ–ª—å–∑—É–µ–º –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ñ–∞–π–ª–∞ ¬´–∑–∞–¥–∞–Ω–∏–µ1.xlsx¬ª. –§–∞–π–ª –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –ø—É—Å—Ç—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π:
```{r}

df <- read_excel('–∑–∞–¥–∞–Ω–∏–µ1.xlsx')

sum(is.na(df))

```
–ú–µ—Ç–æ–¥ –≥–ª–∞–≤–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è –ø–æ–Ω–∏–∂–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö –æ
—Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏–≤–Ω–æ—Å—Ç–∏ –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Ä–æ—Å—Å–∏–π—Å–∫–∏—Ö –≤—É–∑–æ–≤:
```{r}
pca <- prcomp(df[,-c(1)], center = TRUE, scale = TRUE)
summary(pca)
```
–ö–∞–∫ –≤–∏–¥–Ω–æ –∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è 75% –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –Ω–∞–º –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–µ—Ä–≤—ã–µ –ø—è—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç. –û–Ω–∏ –±—É–¥—É—Ç –¥–∞–≤–∞—Ç—å 0.779 –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏.

```{r}
pca$sdev    
```

```{r}
per <- summary(pca)$importance[2,]
qplot(y = per, x = names(per)) + 
  geom_bar(stat = 'identity') +
  labs(title = "–î–æ–ª–∏ –¥–∏—Å–ø–µ—Ä—Å–∏–∏, –æ–±—ä—è—Å–Ω—è–µ–º—ã–µ –≥–ª–∞–≤–Ω—ã–º–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏")
```





## –ó–∞–¥–∞–Ω–∏–µ 2
–ó–∞–¥–∞–Ω–∞ —Å–ª—É—á–∞–π–Ω–∞—è –≤–µ–ª–∏—á–∏–Ω–∞ ùëã, —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–æ—Ç–æ—Ä–æ–π –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ. –ò–∑ –¥–∞–Ω–Ω–æ–π
—Å–ª—É—á–∞–π–Ω–æ–π –≤–µ–ª–∏—á–∏–Ω—ã –±—ã–ª–∞ –ø–æ–ª—É—á–µ–Ω–∞ –≤—ã–±–æ—Ä–∫–∞ ùë• = {3,5,7,9,9,10,11,13,17,19}.

```{r}
x <- c(3,5,7,9,9,10,11,13,17,19) 
h <-  0.25
n <-  length(x)

```
–ù–∞–π–¥–µ–º –æ—Ü–µ–Ω–∫–∏ ùëì(ùë•) –≤ —Ç–æ—á–∫–∞—Ö 5 –∏ 10, –∏—Å–ø–æ–ª—å–∑—É—è:
a) –Ø–¥—Ä–æ –ï–ø–∞–Ω–µ—á–Ω–∏–∫–æ–≤–∞.

–î–ª—è —Ç–æ—á–∫–∏ 5:
```{r}
s_5 = 0
for (i in 1:n){
  x_5 = (x[i] - 5) / h
  s_5 = s_5 + 3/4 * max(1-x_5^2, 0)
}
s_5 = s_5 / (n*h)
s_5
```

–î–ª—è —Ç–æ—á–∫–∏ 10:

```{r}
s_10 = 0
for (i in 1:n){
  x_10 = (x[i] - 10) / h
  s_10 = s_10 + 3/4 * max(1-x_10^2, 0)
}
s_10 = s_10 / (n*h)
s_10
```
–ù–∞–π–¥–µ–º –æ—Ü–µ–Ω–∫–∏ ùëì(ùë•) –≤ —Ç–æ—á–∫–∞—Ö 5 –∏ 10, –∏—Å–ø–æ–ª—å–∑—É—è:
b) –ì–∞—É—Å—Å–æ–≤–æ —è–¥—Ä–æ

–î–ª—è —Ç–æ—á–∫–∏ 5:

```{r}
s_5 = 0
for (i in 1:n){
  x_5 = (x[i] - 5) / h
  s_5 = s_5 + 1/(sqrt(2) * pi) * exp(-x_5^2 /2)
}
s_5 = s_5 / (n*h)
s_5
```
–î–ª—è —Ç–æ—á–∫–∏ 10:

```{r}
s_10 = 0
for (i in 1:n){
  x_10 = (x[i] - 10) / h
  s_10 = s_10 + 1/(sqrt(2) * pi) * exp(-x_10^2 /2)
}
s_10 = s_10 / (n*h)
s_10
```

## –ó–∞–¥–∞–Ω–∏–µ 3

–ò—Å–ø–æ–ª—å–∑—É–µ–º –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö ¬´–∑–∞–¥–∞–Ω–∏–µ3.xlsx¬ª, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –æ—Å–Ω–æ–≤–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ —Å–æ—Ü–∏–∞–ª—å–Ω–æ-—ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–æ–≥–æ —Ä–∞–∑–≤–∏—Ç–∏—è —Ä–µ–≥–∏–æ–Ω–æ–≤ –†–æ—Å—Å–∏–∏.


```{r}
df <- read_excel('–∑–∞–¥–∞–Ω–∏–µ3.xlsx')
sum(is.na(df))
```

–ò–∑–±–∞–≤–∏–º—Å—è –æ—Ç –ø—É—Å—Ç–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –∑–∞–º–µ–Ω–∏–≤ –µ–≥–æ –Ω–∞ —Å—Ä–µ–¥–Ω–µ–µ. –¢–∞–∫–∂–µ –∑–∞–º–µ–Ω–∏–º "," –Ω–∞ ".":
```{r}
for ( i in 2:ncol(df)) {
  df[[i]] <- as.numeric(gsub(",", ".", df[[i]]) )
}

df$x13[is.na(df$x13)] <- mean(df$x13, na.rm = T)
sum(is.na(df))

```

–í—ã–±–µ—Ät–µ–º 4 –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Ä–µ–≥–∏–æ–Ω–æ–≤. –≠—Ç–æ –ü–ª–æ—â–∞–¥—å —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏, —Ç—ã—Å. –∫–º2, –ß–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç—å –Ω–∞—Å–µ–ª–µ–Ω–∏—è, —Ç—ã—Å. —á–µ–ª.,  –í–†–ü, –º–ª–Ω. —Ä—É–±., –û–±—ä–µ–º –¥–æ–±—ã—á–∏ –ø–æ–ª–µ–∑–Ω—ã—Ö –∏—Å–∫–æ–ø–∞–µ–º—ã—Ö, –º–ª–Ω. —Ä—É–±.:
```{r}
df_k <- df[,c(2,3,8,11)]
```

–ù–∞–π–¥–µ–º –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤, –º–µ—Ç–æ–¥–æ–º "Elbow":

```{r}
fviz_nbclust(df_k, kmeans, method = "wss") +
  geom_vline(xintercept = 4, linetype = 2)+
  labs(subtitle = "Elbow method")
```

–ö–∞–∫ –≤–∏–¥–Ω–æ –∏–∑ –≥—Ä–∞—Ñ–∏–∫–∞ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±—É–¥–µ—Ç –ø—Ä–∏ 4 –∫–ª–∞—Å—Ç–µ—Ä–æ–≤.

–û—Å—É—â–µ—Å—Ç–≤–∏–º –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—é –º–µ—Ç–æ–¥–æ–º –∫-—Å—Ä–µ–¥–Ω–∏—Ö –ø—Ä–∏ 4 –∫–ª–∞—Å—Ç–µ—Ä–æ–≤:
```{r}
km.out =kmeans (df_k, 4, nstart =20)

fviz_cluster(km.out, data = df_k,
             geom = "point",
             ellipse.type = "convex", 
             ggtheme = theme_bw()
)

```

–†–µ–∞–ª–∏–∑—É–µ–º –∞–ª–≥–æ—Ä–∏—Ç–º –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–æ–π –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏:
```{r}
hc.complete =hclust (dist(df_k), method ="complete")
hc.average =hclust (dist(df_k), method ="average")
hc.single =hclust (dist(df_k), method ="single")
```

–ò –ø–æ—Å—Ç—Ä–æ–∏–º –¥–µ–Ω–¥–æ–≥—Ä–∞–º–º—ã:
```{r}
par(mfrow =c(1,3))
plot(hc.complete ,main =" Complete Linkage ", xlab="", sub ="",cex =.9)
plot(hc.average , main =" Average Linkage ", xlab="", sub ="",cex =.9)
plot(hc.single , main=" Single Linkage ", xlab="", sub ="",cex =.9)
```

## –ó–∞–¥–∞–Ω–∏–µ 4

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö ¬´–∑–∞–¥–∞–Ω–∏–µ4.xlsx¬ª –∏ –∏–∑–±–∞–≤–∏–º—Å—è –æ—Ç –ø—É—Å—Ç–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –∑–∞–º–µ–Ω–∏–≤ –µ–≥–æ –Ω–∞ —Å—Ä–µ–¥–Ω–µ–µ:

```{r}
df <- read_excel('–∑–∞–¥–∞–Ω–∏–µ4.xlsx')
df$x1[is.na(df$x1)] <- mean(df$x1, na.rm = T)
sum(is.na(df$x1))
```

–ü–æ—Å—Ç—Ä–æ–∏–º —è–¥–µ—Ä–Ω—ã–µ –æ—Ü–µ–Ω–∫–∏ –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏, –∏—Å–ø–æ–ª—å–∑—É—è —è–¥—Ä–æ –ì–∞—É—Å—Å–∞, —è–¥—Ä–æ –ï–ø–∞–Ω–µ—á–Ω–∏–∫–æ–≤–∞, –∞ —Ç–∞–∫–∂–µ —Ç—Ä–µ—É–≥–æ–ª—å–Ω–æ–µ —è–¥—Ä–æ –¥–ª—è –ø–µ—Ä–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π:

```{r}
bw1 <- sqrt(var(df$x1)) * length(df$x1) ^ (-1/5)
kde11<-density(df$x1,bw1,kernel="gaussian")
kde21<-density(df$x1,bw1,kernel="epanechnikov")
kde31<-density(df$x1,bw1,kernel="biweight")
```

–ü–æ—Å—Ç—Ä–æ–∏–º —Ç–∞–∫–∂–µ –≥—Ä–∞—Ñ–∏–∫–∏:

```{r}
plot(kde11, main= 'gaussian')
plot(kde21, main= 'epanechnikov')
plot(kde31, main= 'biweight')
```
–ü–æ—Å—Ç—Ä–æ–∏–º —è–¥–µ—Ä–Ω—ã–µ –æ—Ü–µ–Ω–∫–∏ –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏, –∏—Å–ø–æ–ª—å–∑—É—è —è–¥—Ä–æ –ì–∞—É—Å—Å–∞, —è–¥—Ä–æ –ï–ø–∞–Ω–µ—á–Ω–∏–∫–æ–≤–∞, –∞ —Ç–∞–∫–∂–µ —Ç—Ä–µ—É–≥–æ–ª—å–Ω–æ–µ —è–¥—Ä–æ –¥–ª—è –≤—Ç–æ—Ä–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π:

```{r}
bw <- sqrt(var(df$x2)) * length(df$x2) ^ (-1/5)
kde1<-density(df$x2,bw,kernel="gaussian")
kde2<-density(df$x2,bw,kernel="epanechnikov")
kde3<-density(df$x2,bw,kernel="biweight")
```
–ü–æ—Å—Ç—Ä–æ–∏–º —Ç–∞–∫–∂–µ –≥—Ä–∞—Ñ–∏–∫–∏:

```{r}
plot(kde1, main= 'gaussian')
plot(kde2, main= 'epanechnikov')
plot(kde3, main= 'biweight')
```





## –ó–∞–¥–∞–Ω–∏–µ 5


–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö ¬´Weekly¬ª –∏–∑ –ø–∞–∫–µ—Ç–∞ ¬´ISLR¬ª:

```{r}
df <-  Weekly
sum(is.na(df))
```

–ü–æ—Å—Ç—Ä–æ–∏–º –º–æ–¥–µ–ª—å –ª–∏–Ω–µ–π–Ω–æ–≥–æ –¥–∏—Å–∫—Ä–∏–º–∏–Ω–∞–Ω—Ç–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞, –∏—Å–ø–æ–ª—å–∑—É—è –≤ –∫–∞—á–µ—Å—Ç–≤–µ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é ¬´Lag2¬ª.

```{r}
lda <- lda(Lag2 ~ ., data = df)
lda$scaling
lda$svd
lda$N
```


